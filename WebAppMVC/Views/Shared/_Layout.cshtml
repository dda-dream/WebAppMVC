@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
@using WebAppMVC_Utility

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@ViewData["Title"] - WebAppMVC</title>

	<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
	<link rel="stylesheet" href="~/WebAppMVC.styles.css" asp-append-version="true" />

	<!--sweetalert2.github.io-->
	<script src="~/lib/jquery/dist/jquery.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<!--sweetalert2.github.io-->
	<!--SUMMERNOTE WORKED 100%-->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
	<link href="https://cdn.jsdelivr.net/npm/summernote@0.9.0/dist/summernote-bs4.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/summernote@0.9.0/dist/summernote-bs4.min.js"></script>
	<!--SUMMERNOTE WORKED 100%-->
	<!--Загружается долго  https://datatables.net/  -->
	<link rel="stylesheet" href="//cdn.datatables.net/2.3.4/css/dataTables.dataTables.min.css" />
	<script src="//cdn.datatables.net/2.3.4/js/dataTables.min.js"></script>
	<!--Загружается долго  https://datatables.net/  -->
	<!--TOASTR-->
	<!--
	<script src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
	<link href="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet" />
	-->
	<!--TOASTR-->
	<!--BOOTSTRAP-->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
	<!--BOOTSTRAP-->
	<!--BOOTSTRAP ICONS-->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
	<!--BOOTSTRAP ICONS-->
	<!-- Syncfusion ASP.NET Core controls styles -->
	<link rel="stylesheet" href="https://cdn.syncfusion.com/ej2/31.2.2/fluent.css" />
	<!-- Syncfusion ASP.NET Core controls scripts -->
	<script src="https://cdn.syncfusion.com/ej2/31.2.2/dist/ej2.min.js"></script>



	<!-- SIGNALR -->
	<script src="~/lib/microsoft/signalr/dist/browser/signalr.js"></script>


</head>








<body>
	<header>
		<nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-gradient border-bottom box-shadow mb-3">
			<div class="container-fluid">

				<a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="Index">-=My Site (home)=-</a>

				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse"
						aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">


					<ul class="navbar-nav flex-grow-1">

						<li class="nav-item">
							<a class="nav-link text-danger bg-light" asp-area="" asp-controller="Home" asp-action="Shop">Магазин</a>
						</li>
						<li class="nav-item">
							<a class="nav-link text-danger bg-light" asp-area="" asp-controller="MyDailyJournal" asp-action="Index">Ежедневник</a>
						</li>

						<li class="nav-item">
							<a class="nav-link text-danger bg-light" asp-area="" asp-controller="Chat" asp-action="Index">Чат</a>
						</li>
						<li class="nav-item">
							<a class="nav-link text-danger bg-light" asp-area="" asp-controller="Chat" asp-action="Chat_New">Чат(new)</a>
						</li>

						@if (User.IsInRole(WC.AdminRole))
						{
							<li class="nav-item dropdown">
								<a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
									Редактор магазина
								</a>
								<ul class="dropdown-menu">
									<a class="dropdown-item text-dark" asp-area="" asp-controller="Category" asp-action="Index">Category</a>
									<a class="dropdown-item text-dark" asp-area="" asp-controller="Product" asp-action="Index">Product</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-dark" asp-area="Identity" asp-page="/Account/Register"> Create Admin User</a>
								</ul>
							</li>

							<li class="nav-item dropdown">
								<a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
									Управление магазином
								</a>
								<ul class="dropdown-menu">
									<a class="dropdown-item text-dark" asp-area="" asp-controller="Order" asp-action="Index">Ордера(Order)</a>
									<a class="dropdown-item text-dark" asp-area="" asp-controller="Sales" asp-action="Index">Заказы(Sales)</a>
								</ul>
							</li>
						}

						<li>
							@if (HttpContextAccessor.HttpContext.Session.Get<List<ShoppingCart>>(WC.SessionCart) != null)
							{
								<a asp-action="Index" asp-controller="Cart" class="nav-link">
									@{
										var count = HttpContextAccessor.HttpContext.Session.Get<List<ShoppingCart>>(WC.SessionCart).Count;
									}
									<i>(В корзине: @count)</i>
								</a>
							}
							else
							{
								<a href="#" class="nav-link">
									<i>(В корзине пусто!)</i>
								</a>
							}
						</li>


					</ul>
					<partial name="_LoginPartial" />

				</div>
			</div>
		</nav>
	</header>


	<!-- BOOTSRAP TOAST -->
	<div id="toastContainer" class="position-fixed top-0 start-50 translate-middle-x mt-3" style="z-index: 1055;">
		<div id="centerToast" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
			<div class="d-flex">
				<div class="toast-body">
					Успешно!
				</div>
				<button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Закрыть"></button>
			</div>
		</div>
	</div>

	<script>
		function showToast(message, type = 'success', delay = 3000) {
			const toastEl = document.getElementById('centerToast');

			if (!toastEl) {
				console.error("Toast элемент не найден!");
				return;
			}

			// Меняем текст и цвет
			const bodyEl = toastEl.querySelector('.toast-body');
			if (bodyEl) bodyEl.textContent = message;

			toastEl.className = `toast align-items-center text-bg-${type} border-0`;

			// Создаём и показываем toast
			const toast = new bootstrap.Toast(toastEl, { delay: delay, autohide: true });
			toast.show();
		}
	</script>
	<!-- BOOTSRAP TOAST -->



	<main role="main" class="pb-3">
		<partial name="_Notifications" />
		@RenderBody()
	</main>

	<footer class="border-top footer text-muted">
	</footer>

	<ejs-scripts></ejs-scripts>

	@await RenderSectionAsync("Scripts", required: false)
</body>
</html>
